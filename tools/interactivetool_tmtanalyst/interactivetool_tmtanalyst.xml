<tool id="interactive_tool_tmtanalyst" tool_type="interactive" name="TMT Analyst" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@" profile="20.01" license="MIT">
    <description>Analyze and Visualize Label-Free Proteomics output from MaxQuant</description>

    <xrefs>
        <!-- TMT-analyst oesn't appear to be in bio.tools -->
        <!-- <xref type="bio.tools">LFQ-Analyst</xref> -->
    </xrefs>

    <macros>
        <token name="@TOOL_VERSION@">0.9.1</token>
        <token name="@VERSION_SUFFIX@">0</token>
        <token name="@PORT@">8000</token>
    </macros>

    <edam_topics>
        <edam_topic>topic_0121</edam_topic>
    </edam_topics>

    <edam_operations>
        <edam_operation>operation_3214</edam_operation>
    </edam_operations>

    <requirements>
        <!-- this container has port 8888 exposed -->
        <container type="docker">haileyzhang/tmt-analyst:v@TOOL_VERSION@</container>
    </requirements>

    <entry_points>
        <entry_point name="TMT-analyst" requires_domain="True">
            <port>@PORT@</port>
        </entry_point>
    </entry_points>

    <command detect_errors="exit_code"><![CDATA[

cp '$run_tmtanalyst' '$outfile' &&
cd /srv/shiny-server/tmt-analyst &&
Rscript '$run_tmtanalyst'

    ]]></command>

    <configfiles>
        <configfile name="run_tmtanalyst"><![CDATA[
## wrapper to run LFQAnalyst from the shiny-server directory
source('runApp.R')
options(shiny.port=@PORT@)

TMTAnalyst(protein_path="$protein_groups", exp_path="$design")

        ]]></configfile>
    </configfiles>

    <inputs>
        <param name="protein_groups" type="data" format="txt" label="ProteinGroups.txt" help="" />
        <param name="design" type="data" format="txt" label="Experimental Design Matrix" help="" />
    </inputs>

    <outputs>
        <data name="outfile" format="txt"
          label="${tool.name} on ${on_string}: Rscript" />
    </outputs>

    <tests>
        <!-- Hint: You can use [ctrl+alt+t] after defining the inputs/outputs to auto-scaffold some basic test cases. -->
    </tests>

    <help><![CDATA[

.. class:: infomark

LFQ-Analyst
===========

A tool for analysing label-free quantitative proteomics dataset
https://bioinformatics.erc.monash.edu/apps/LFQ-Analyst/


Motivation
----------

-  Automate downstream statistical analysis of Label free quantitative
   proteomics data (generated by MaxQuant)

Input
-----

-  MaxQuant **proteinGroups.txt** file
-  An experiment design table (tab separated file) containing three
   columns (“label”, “condition”, “replicate”)

Data pre-filtering criteria
---------------------------

-  Remove potential contaminants
-  Remove reverse sequences
-  Remove proteins identified only by sites
-  Remove proteins identified/quantified by a single Razor or unique
   peptide
-  Remove observation with high proportion of missing values (intensity
   values must be present at least 2 out of three replicates)

    ]]></help>
    <citations>
        <citation type="doi">10.1021/acs.jproteome.9b00496</citation>
    </citations>
</tool>
